VJ1 EQU FFFF1000

VJ2 EQU FFFF2000
VJ2BS EQU FFFF2004

VJ3 EQU FFFF3000
VJ3RADIM EQU FFFF3004
VJ3GOTOV EQU FFFF3008
VJ3ZAUSTAVI EQU FFFF300C
		
		ORG 0
		MOVE 10000, SP
		JP GLAVNI
		
		ORG 8
		DW 200
		
				
GLAVNI	MOVE %B 10000, SR
		MOVE 1, R0
		STORE R0, (VJ3ZAUSTAVI)
		
PETLJA	LOAD R0, (STOP)
		OR R0, R0, R0
		JR_NZ KRAJ

		LOAD R0, (VJ2BS)  ;ISPITIVANJE VJ2
		OR R0, R0, R0
		JR_Z PETLJA
		
		LOAD R1, (BROJ)	  ;STAVLJANJE OBRADENOG BROJA U VJ2
		STORE R1, (VJ2)
		STORE R1, (VJ2BS)
		
		LOAD R0, (BROJAC)  ;BROJAC + 1
		ADD R0, 1, R0
		STORE R0, (BROJAC)
		JR PETLJA
		
		
		
		
		ORG 200
		PUSH R0	  ;KONTEKST
		MOVE SR, R0
		PUSH R0
		
		STORE R0, (VJ3RADIM)   ;OBRADA PODATAKA
		LOAD R0, (VJ1)		   ;UZIMANJE BROJA IZ VJ1
		OR R0, R0, R0
		JR_N NEG
		
		PUSH R0
		CALL OBRADI			   ;POZIVANJE POTPROGRAMA
		ADD SP, 4, SP
		STORE R0, (BROJ)
		
		LOAD R1, (BROJAC)	   ;SPREMANJE BROJACA NA VJ3
		STORE R1, (VJ3)
		
DALJE	POP R0				   ;KONTEKST
		MOVE R0, SR
		POP R0
		STORE R0, (VJ3GOTOV)
		RETI
		
		
OBRADI  PUSH R1

		LOAD R0, (SP+8)
		SUB R0, 1, R0
		MOVE 2, R1
		SHL R1, R0, R0
		
		POP R1
		RET
		
NEG 	STORE R1, (STOP)
		JR DALJE
		
		
KRAJ    MOVE 0, R0
		STORE R0, (VJ3ZAUSTAVI)
		HALT
		
BROJ 	DW 0
BROJAC  DW 0
STOP 	DW 0

